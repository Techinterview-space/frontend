<article class="container my-5" *ngIf="data; else loading">
  <div class="card mb-5">
    <div class="card-body">
      <header class="overview-header mb-5">
        <h1>Зарплаты в IT в Казахстане</h1>
        <div class="overview-subtitle">
          <p>
            Дата: <strong>{{ currentDate }}</strong>
          </p>
          <p>
            Статистика зарплат на <strong>{{ currentDate }}</strong> для IT
            специалистов в Казахстане, собранная через анонимные анкеты.
          </p>
          <p>
            Эта страница полезна для SEO и GEO-таргетинга. Если вам нужны
            интерактивные графики и фильтры, перейдите на страницу
            <a href="/salaries">Зарплаты</a>.
          </p>
        </div>
      </header>
    </div>
  </div>

  <!-- Summary -->
  <section class="mb-5">
    <div class="card">
      <div class="card-body">
        <h2>Сводка</h2>
        <p>
          Всего анкет в статистике:
          <strong>{{ data.totalCountInStats }}</strong
          >.
        </p>
        <figure>
          <table
            class="table overview-table"
            aria-label="Сводка зарплат по локальным и удаленным компаниям"
          >
            <thead>
              <tr>
                <th></th>
                <th>Средняя (KZT)</th>
                <th>Медиана (KZT)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Локальные компании</td>
                <td>{{ formatMoney(data.averageSalary) }}</td>
                <td>{{ formatMoney(data.medianSalary) }}</td>
              </tr>
              <tr *ngIf="data.averageRemoteSalary">
                <td>Удаленные / зарубежные компании</td>
                <td>{{ formatMoney(data.averageRemoteSalary) }}</td>
                <td>{{ formatMoney(data.medianRemoteSalary) }}</td>
              </tr>
            </tbody>
          </table>
          <figcaption>
            Источник:
            <cite
              ><a href="https://techinterview.space/salaries"
                >Techinterview.space</a
              ></cite
            >
          </figcaption>
        </figure>
      </div>
    </div>
  </section>

  <!-- Salaries by Grade (Local) -->
  <section class="mb-5" *ngIf="localGrades.length > 0">
    <div class="card">
      <div class="card-body">
        <h2>Зарплаты по грейдам разработчиков (локальные компании)</h2>
        <figure>
          <table
            class="table overview-table"
            aria-label="Зарплаты по грейдам разработчиков для локальных компаний"
          >
            <thead>
              <tr>
                <th>Грейд</th>
                <th>Кол-во анкет</th>
                <th>Средняя (KZT)</th>
                <th>Медиана (KZT)</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of localGrades">
                <td>{{ gradeLabel(item.grade) }}</td>
                <td>{{ item.count }}</td>
                <td>{{ formatMoney(item.averageSalary) }}</td>
                <td>{{ formatMoney(item.medianSalary) }}</td>
              </tr>
            </tbody>
          </table>
          <figcaption>
            Источник:
            <cite
              ><a href="https://techinterview.space/salaries"
                >Techinterview.space</a
              ></cite
            >
          </figcaption>
        </figure>
      </div>
    </div>
  </section>

  <!-- Salaries by Grade (Remote) -->
  <section class="mb-5" *ngIf="remoteGrades.length > 0">
    <div class="card">
      <div class="card-body">
        <h2>Зарплаты по грейдам разработчиков (удаленные / зарубежные компании)</h2>
        <figure>
          <table
            class="table overview-table"
            aria-label="Зарплаты по грейдам разработчиков для удаленных компаний"
          >
            <thead>
              <tr>
                <th>Грейд</th>
                <th>Кол-во анкет</th>
                <th>Средняя (KZT)</th>
                <th>Медиана (KZT)</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of remoteGrades">
                <td>{{ gradeLabel(item.grade) }}</td>
                <td>{{ item.count }}</td>
                <td>{{ formatMoney(item.averageSalary) }}</td>
                <td>{{ formatMoney(item.medianSalary) }}</td>
              </tr>
            </tbody>
          </table>
          <figcaption>
            Источник:
            <cite
              ><a href="https://techinterview.space/salaries/"
                >Techinterview.space</a
              ></cite
            >
          </figcaption>
        </figure>
      </div>
    </div>
  </section>

  <!-- Grade Distribution (Min/Max) -->
  <section class="mb-5" *ngIf="localBoxPlot.length > 0">
    <div class="card">
      <div class="card-body">
        <h2>Распределение зарплат по грейдам (локальные компании)</h2>
        <figure>
          <table
            class="table overview-table"
            aria-label="Распределение зарплат по грейдам для локальных компаний"
          >
            <thead>
              <tr>
                <th>Грейд</th>
                <th>Мин (KZT)</th>
                <th>Q1 (KZT)</th>
                <th>Медиана (KZT)</th>
                <th>Средняя (KZT)</th>
                <th>Q3 (KZT)</th>
                <th>Макс (KZT)</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of localBoxPlot">
                <td>{{ gradeLabel(item.grade) }}</td>
                <td>{{ formatMoney(item.min) }}</td>
                <td>{{ formatMoney(item.q1) }}</td>
                <td>{{ formatMoney(item.median) }}</td>
                <td>{{ formatMoney(item.mean) }}</td>
                <td>{{ formatMoney(item.q3) }}</td>
                <td>{{ formatMoney(item.max) }}</td>
              </tr>
            </tbody>
          </table>
          <figcaption>
            Источник:
            <cite
              ><a href="https://techinterview.space/salaries"
                >Techinterview.space</a
              ></cite
            >
          </figcaption>
        </figure>
      </div>
    </div>
  </section>

  <!-- Salaries by City -->
  <ng-container *ngIf="cityChartLocal as cityChart">
    <section class="mb-5">
      <div class="card">
        <div class="card-body">
          <h2>Зарплаты по городам (локальные компании)</h2>
          <figure>
            <table
              class="table overview-table"
              aria-label="Зарплаты по городам для локальных компаний"
            >
              <thead>
                <tr>
                  <th>Город</th>
                  <th>Кол-во анкет</th>
                  <th>Средняя (KZT)</th>
                  <th>Медиана (KZT)</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let label of cityChart.labels; let i = index">
                  <td>{{ label }}</td>
                  <td>{{ cityChart.itemsCount[i] }}</td>
                  <td>{{ formatMoney(cityChart.averageSalaries[i]) }}</td>
                  <td>{{ formatMoney(cityChart.medianSalaries[i]) }}</td>
                </tr>
              </tbody>
            </table>
            <figcaption>
              Источник:
              <cite
                ><a href="https://techinterview.space/salaries"
                  >Techinterview.space</a
                ></cite
              >
            </figcaption>
          </figure>
        </div>
      </div>
    </section>
  </ng-container>

  <!-- Salaries by Experience -->
  <ng-container *ngIf="experienceChartLocal as expChart">
    <section class="mb-5">
      <div class="card">
        <div class="card-body">
          <h2>Зарплаты по опыту (локальные компании)</h2>
          <figure>
            <table
              class="table overview-table"
              aria-label="Зарплаты по опыту для локальных компаний"
            >
              <thead>
                <tr>
                  <th>Опыт (лет)</th>
                  <th>Кол-во анкет</th>
                  <th>Средняя (KZT)</th>
                  <th>Медиана (KZT)</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let label of expChart.labels; let i = index">
                  <td>{{ label.start }}&ndash;{{ label.end }}</td>
                  <td>{{ expChart.itemsCount[i] }}</td>
                  <td>{{ formatMoney(expChart.averageSalaries[i]) }}</td>
                  <td>{{ formatMoney(expChart.medianSalaries[i]) }}</td>
                </tr>
              </tbody>
            </table>
            <figcaption>
              Источник:
              <cite
                ><a href="https://techinterview.space/salaries"
                  >Techinterview.space</a
                ></cite
              >
            </figcaption>
          </figure>
        </div>
      </div>
    </section>
  </ng-container>

  <!-- Salaries by Age -->
  <ng-container *ngIf="ageChartLocal as ageChart">
    <section class="mb-5">
      <div class="card">
        <div class="card-body">
          <h2>Зарплаты по возрасту (локальные компании)</h2>
          <figure>
            <table
              class="table overview-table"
              aria-label="Зарплаты по возрасту для локальных компаний"
            >
              <thead>
                <tr>
                  <th>Возраст</th>
                  <th>Кол-во анкет</th>
                  <th>Средняя (KZT)</th>
                  <th>Медиана (KZT)</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let label of ageChart.labels; let i = index">
                  <td>{{ label.start }}&ndash;{{ label.end }}</td>
                  <td>{{ ageChart.itemsCount[i] }}</td>
                  <td>{{ formatMoney(ageChart.averageSalaries[i]) }}</td>
                  <td>{{ formatMoney(ageChart.medianSalaries[i]) }}</td>
                </tr>
              </tbody>
            </table>
            <figcaption>
              Источник:
              <cite
                ><a href="https://techinterview.space/salaries"
                  >Techinterview.space</a
                ></cite
              >
            </figcaption>
          </figure>
        </div>
      </div>
    </section>
  </ng-container>

  <!-- Professions Distribution -->
  <ng-container *ngIf="professionsLocal as profs">
    <section class="mb-5" *ngIf="profs.items.length > 0">
      <div class="card">
        <div class="card-body">
          <h2>Распределение по профессиям (локальные компании)</h2>
          <figure>
            <table
              class="table overview-table"
              aria-label="Распределение по профессиям для локальных компаний"
            >
              <thead>
                <tr>
                  <th>Профессия</th>
                  <th>Кол-во анкет</th>
                  <th>Доля (%)</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of profs.items">
                  <td>{{ item.profession.title }}</td>
                  <td>{{ item.count }}</td>
                  <td>{{ item.percentage | number: "1.1-1" }}</td>
                </tr>
                <tr *ngIf="profs.otherCount > 0">
                  <td>Другое</td>
                  <td>{{ profs.otherCount }}</td>
                  <td>{{ profs.otherPercentage | number: "1.1-1" }}</td>
                </tr>
              </tbody>
            </table>
            <figcaption>
              Источник:
              <cite
                ><a href="https://techinterview.space/salaries"
                  >Techinterview.space</a
                ></cite
              >
            </figcaption>
          </figure>
        </div>
      </div>
    </section>
  </ng-container>

  <!-- Skills -->
  <ng-container *ngIf="skillsData as skills">
    <section class="mb-5" *ngIf="skills.items.length > 0">
      <div class="card">
        <div class="card-body">
          <h2>Топ навыков</h2>
          <figure>
            <table class="table overview-table" aria-label="Топ навыков в IT">
              <thead>
                <tr>
                  <th>Навык</th>
                  <th>Кол-во анкет</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of skills.items">
                  <td>{{ item.skill.title }}</td>
                  <td>{{ item.count }}</td>
                </tr>
              </tbody>
            </table>
            <figcaption>
              Источник:
              <cite
                ><a href="https://techinterview.space/salaries"
                  >Techinterview.space</a
                ></cite
              >
            </figcaption>
          </figure>
        </div>
      </div>
    </section>
  </ng-container>

  <!-- Work Industries -->
  <ng-container *ngIf="industriesData as industries">
    <section class="mb-5" *ngIf="industries.items.length > 0">
      <div class="card">
        <div class="card-body">
          <h2>Отрасли работы</h2>
          <figure>
            <table
              class="table overview-table"
              aria-label="Распределение по отраслям"
            >
              <thead>
                <tr>
                  <th>Отрасль</th>
                  <th>Кол-во анкет</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of industries.items">
                  <td>{{ item.industry.title }}</td>
                  <td>{{ item.count }}</td>
                </tr>
              </tbody>
            </table>
            <figcaption>
              Источник:
              <cite
                ><a href="https://techinterview.space/salaries"
                  >Techinterview.space</a
                ></cite
              >
            </figcaption>
          </figure>
        </div>
      </div>
    </section>
  </ng-container>

  <!-- Gender Distribution -->
  <ng-container *ngIf="genderLocal as gender">
    <section class="mb-5" *ngIf="gender.items.length > 0">
      <div class="card">
        <div class="card-body">
          <h2>Распределение по полу (локальные компании)</h2>
          <figure>
            <table
              class="table overview-table"
              aria-label="Распределение по полу для локальных компаний"
            >
              <thead>
                <tr>
                  <th>Пол</th>
                  <th>Кол-во анкет</th>
                  <th>Доля (%)</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of gender.items">
                  <td>{{ genderLabel(item.gender) }}</td>
                  <td>{{ item.count }}</td>
                  <td>{{ item.percentage | number: "1.1-1" }}</td>
                </tr>
              </tbody>
            </table>
            <figcaption>
              Источник:
              <cite
                ><a href="https://techinterview.space/salaries"
                  >Techinterview.space</a
                ></cite
              >
            </figcaption>
          </figure>
        </div>
      </div>
    </section>
  </ng-container>

  <!-- CTA -->
  <section class="cta-section mt-5">
    <div class="card">
      <div class="card-body">
        <p>
          Для интерактивных графиков, фильтров и подробной аналитики
          <a routerLink="/salaries">перейдите в полный дашборд зарплат</a>
          (требуется вход).
        </p>
      </div>
    </div>
  </section>
</article>

<ng-template #loading>
  <div class="container mt-5">
    <app-data-loader [title]="''">
      <div class="mt-3 pb-5">
        <div class="text-muted h2 d-flex justify-content-center">
          Загрузка данных по зарплатам...
        </div>
      </div>
    </app-data-loader>
  </div>
</ng-template>
